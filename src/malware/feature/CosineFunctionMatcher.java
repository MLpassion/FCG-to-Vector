package malware.feature;

public class CosineFunctionMatcher implements FunctionMatcher<Double[]> {

  @Override
  public boolean matching(Double[] function1Feature, Double[] function2Feature,
      float threashold) {
    double cosSim = similarity(function1Feature, function2Feature);
    
    return Math.abs(cosSim) < threashold;
  }

  @Override
  public double similarity(Double[] function1Feature, Double[] function2Feature) {
    double dotProd = util.math.LinearAlgebra.dotProduct(function1Feature, function2Feature);
    double mag1 = util.math.LinearAlgebra.magnitude(function1Feature);
    double mag2 = util.math.LinearAlgebra.magnitude(function2Feature);
    
    if (mag1 == 0 || mag2 == 0) {
      return 0;
    }
    
    return dotProd / (mag1 * mag2);
  }

}
