package malware.data;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;

public class MicrosoftDatasetReaders {

  /***
   * Label file format:
   * 
   * "Id","Class" "01kcPWA9K2BOxQeS5Rju",1 "04EjIdbPV5e1XroFOpiN",1 ...
   * 
   * @param classLabelFile
   * @return
   * @throws FileNotFoundException
   */
  public static Map<String, String> readClassLables(File classLabelFile)
      throws FileNotFoundException {
    Map<String, String> classLabels = new HashMap<String, String>();

    Scanner in = new Scanner(classLabelFile);

    boolean first = true;
    while (in.hasNextLine()) {
      if (first) {
        first = false;
        in.nextLine();
        continue;
      }

      String[] cols = in.nextLine().split(",");
      if (cols.length != 2) {
        continue;
      }
      classLabels.put(cols[0].substring(1, cols[0].length() - 1), cols[1]);
    }

    return classLabels;
  }

}
